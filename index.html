<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lunar Calendar Tracker</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23, #1a1a3e, #2d2d5f);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .date-display {
            font-size: 1.4rem;
            margin-bottom: 10px;
            color: #fff;
            font-weight: bold;
        }
        
        .moon-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            margin: 40px 0;
            flex-wrap: wrap;
        }
        
        .moon-phase {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: #333;
            position: relative;
            box-shadow: 0 0 40px rgba(255,255,255,0.3);
            overflow: hidden;
        }
        
        .moon-light {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(90deg, #f5f5dc 0%, #e6e6fa 100%);
            transform-origin: center;
        }
        
        .phase-info {
            max-width: 300px;
        }
        
        .phase-name {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #f0f0f0;
        }
        
        .illumination {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #ccc;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        button {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: #fff;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        button:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .calendar-mini {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            backdrop-filter: blur(10px);
        }
        
        .month-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            gap: 15px;
        }
        
        .month-nav button {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: #fff;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2rem;
            min-width: 40px;
        }
        
        .month-nav button:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.1);
        }
        
        .month-year {
            font-size: 1.3rem;
            font-weight: bold;
            flex: 1;
            text-align: center;
        }
        
        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .weekdays div {
            padding: 8px;
            font-weight: bold;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }
        
        .days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 3px;
        }
        
        .day {
            aspect-ratio: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255,255,255,0.05);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 40px;
        }
        
        .day:hover {
            background: rgba(255,255,255,0.15);
        }
        
        .day.today {
            background: rgba(255,215,0,0.3);
            border: 2px solid #ffd700;
        }
        
        .day.selected {
            background: rgba(100,150,255,0.3);
            border: 2px solid #6496ff;
        }
        
        .day.vietnamese-holiday {
            background: rgba(255,100,100,0.4);
            border: 2px solid #ff6464;
            position: relative;
        }
        
        .day.vietnamese-holiday::after {
            content: 'üèÆ';
            position: absolute;
            top: -2px;
            right: -2px;
            font-size: 12px;
        }

        .day.lunar-first-day {
            background: rgba(255,215,0,0.2);
            border: 2px solid rgba(255,215,0,0.6);
            position: relative;
        }

        .day.lunar-first-day::before {
            content: 'üåë';
            position: absolute;
            top: -2px;
            left: -2px;
            font-size: 10px;
        }

        .day.lunar-full-moon {
            background: rgba(200,200,255,0.3);
            border: 2px solid rgba(150,150,255,0.8);
            position: relative;
        }

        .day.lunar-full-moon::before {
            content: 'üåï';
            position: absolute;
            top: -2px;
            left: -2px;
            font-size: 10px;
        }

        .day.lunar-month-end {
            background: rgba(150,100,200,0.2);
            border: 2px solid rgba(150,100,200,0.6);
        }
        
        .holiday-info {
            background: rgba(255,100,100,0.2);
            border: 1px solid rgba(255,100,100,0.5);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: left;
        }
        
        .holiday-info h3 {
            color: #ff9999;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .lunar-date {
            font-size: 1.2rem;
            color: #ffd700;
            margin-bottom: 20px;
            font-weight: bold;
            background: rgba(255,215,0,0.1);
            padding: 10px 20px;
            border-radius: 8px;
            display: inline-block;
        }
        
        .mobile-app-banner {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            font-weight: bold;
            text-decoration: none;
            transition: all 0.3s ease;
            max-width: 90%;
        }

        .mobile-app-banner:hover {
            transform: translateX(-50%) translateY(-3px);
            box-shadow: 0 12px 28px rgba(0,0,0,0.4);
        }

        .mobile-app-banner .icon {
            font-size: 1.5rem;
            animation: pulse 2s infinite;
        }

        .mobile-app-banner .close-btn {
            margin-left: 10px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .mobile-app-banner .text {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .mobile-app-banner .title {
            font-size: 1rem;
            margin-bottom: 2px;
        }

        .mobile-app-banner .subtitle {
            font-size: 0.75rem;
            opacity: 0.9;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @media (max-width: 600px) {
            .moon-container { flex-direction: column; gap: 20px; }
            .moon-phase { width: 150px; height: 150px; }
            h1 { font-size: 2rem; }
            .controls { flex-direction: column; align-items: center; }

            .mobile-app-banner {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåô Lunar Calendar Tracker</h1>
        
        <div class="date-display" id="dateDisplay"></div>
        <div class="lunar-date" id="lunarDate"></div>
        
        <div class="holiday-info" id="holidayInfo" style="display: none;">
            <h3 id="holidayNameEn"></h3>
            <h3 id="holidayNameVi" style="color: #ffb3b3; font-size: 1rem; margin-top: 5px;"></h3>
            <div style="margin-top: 12px;">
                <p id="holidayDescriptionEn" style="margin-bottom: 10px;"></p>
                <p id="holidayDescriptionVi" style="color: #e0e0e0; font-style: italic;"></p>
            </div>
            <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.2);">
                <strong>Traditions:</strong> <span id="holidayTraditions"></span>
            </div>
            <div id="offeringInfo" style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.2); display: none;">
                <strong>üôè Altar Offerings (ƒê·ªì C√∫ng B√†n Th·ªù):</strong>
                <p id="offeringDescription" style="margin-top: 5px; color: #ddd;"></p>
            </div>
        </div>
        
        <div class="moon-container">
            <div class="moon-phase" id="moonPhase">
                <div class="moon-light" id="moonLight"></div>
            </div>
            
            <div class="phase-info">
                <div class="phase-name" id="phaseName"></div>
                <div class="illumination" id="illumination"></div>
                <div id="phaseDescription"></div>
            </div>
        </div>
        
        <div class="controls">
            <button onclick="changeDate(-1)">‚Üê Previous Day</button>
            <button onclick="goToToday()">Today</button>
            <button onclick="changeDate(1)">Next Day ‚Üí</button>
        </div>
        
        <div class="calendar-mini">
            <div class="month-nav">
                <button id="prevMonth" onclick="changeMonth(-1)">‚Üê</button>
                <div class="month-year" id="monthYear"></div>
                <button id="nextMonth" onclick="changeMonth(1)">‚Üí</button>
            </div>
            <div class="weekdays">
                <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div>
                <div>Thu</div><div>Fri</div><div>Sat</div>
            </div>
            <div class="days-grid" id="daysGrid"></div>
        </div>
    </div>

    <script>
        let currentDate = new Date();
        
        /**
         * Vietnamese lunar calendar holidays with bilingual descriptions
         * Key format: 'lunar_month/lunar_day'
         *
         * To add a new festival, simply add a new entry following this format:
         * 'M/D': {
         *     nameEn: 'English name',
         *     nameVi: 'Vietnamese name',
         *     descriptionEn: 'English description',
         *     descriptionVi: 'Vietnamese description',
         *     traditions: 'Common traditions and practices'
         * }
         */
        const vietnameseHolidays = {
            '1/1': {
                nameEn: 'T·∫øt Nguy√™n ƒê√°n (Vietnamese New Year)',
                nameVi: 'T·∫øt Nguy√™n ƒê√°n',
                descriptionEn: 'The most important holiday in Vietnamese culture, celebrating the arrival of spring and the lunar new year. Families gather, pay respects to ancestors, exchange lucky money, and enjoy traditional foods.',
                descriptionVi: 'Ng√†y l·ªÖ quan tr·ªçng nh·∫•t trong vƒÉn h√≥a Vi·ªát Nam, ch√†o ƒë√≥n m√πa xu√¢n v√† nƒÉm m·ªõi √¢m l·ªãch. Gia ƒë√¨nh sum h·ªçp, th·ªù c√∫ng t·ªï ti√™n, trao l√¨ x√¨ may m·∫Øn v√† th∆∞·ªüng th·ª©c c√°c m√≥n ƒÉn truy·ªÅn th·ªëng.',
                traditions: 'Visiting temples, giving red envelopes, eating b√°nh ch∆∞ng',
                offerings: 'B√°nh ch∆∞ng, b√°nh t√©t, pickled onions, boiled chicken, five-fruit tray, sticky rice, traditional cakes, tea, wine'
            },
            '1/2': {
                nameEn: 'T·∫øt Nguy√™n ƒê√°n (Day 2)',
                nameVi: 'T·∫øt Nguy√™n ƒê√°n (M√πng 2)',
                descriptionEn: 'Second day of T·∫øt - traditionally for visiting friends, teachers, and extended family. Many people also visit pagodas to pray for good fortune.',
                descriptionVi: 'Ng√†y m√πng 2 T·∫øt - truy·ªÅn th·ªëng ƒëi thƒÉm b·∫°n b√®, th·∫ßy c√¥ v√† h·ªç h√†ng xa. Nhi·ªÅu ng∆∞·ªùi c≈©ng ƒëi ch√πa c·∫ßu may m·∫Øn.',
                traditions: 'Visiting relatives, temple visits, family gatherings',
                offerings: 'Continued T·∫øt offerings: fruits, cakes, tea, incense'
            },
            '1/3': {
                nameEn: 'T·∫øt Nguy√™n ƒê√°n (Day 3)',
                nameVi: 'T·∫øt Nguy√™n ƒê√°n (M√πng 3)',
                descriptionEn: 'Third day of T·∫øt - often considered an unlucky day for visiting. Many families stay home or visit graves of deceased relatives.',
                descriptionVi: 'Ng√†y m√πng 3 T·∫øt - th∆∞·ªùng ƒë∆∞·ª£c coi l√† ng√†y x·∫•u ƒë·ªÉ ƒëi thƒÉm h·ªèi. Nhi·ªÅu gia ƒë√¨nh ·ªü nh√† ho·∫∑c ƒëi thƒÉm m·ªô ng∆∞·ªùi th√¢n ƒë√£ khu·∫•t.',
                traditions: 'Ancestral worship, staying home with family',
                offerings: 'Incense, fruits, flowers for ancestors and graves'
            },
            '1/15': {
                nameEn: 'T·∫øt Nguy√™n Ti√™u (Lantern Festival)',
                nameVi: 'T·∫øt Nguy√™n Ti√™u (R·∫±m th√°ng Gi√™ng)',
                descriptionEn: 'First full moon of the lunar year. Festival of lights with colorful lanterns, lion dances, and releasing lanterns on water to honor ancestors.',
                descriptionVi: 'TrƒÉng tr√≤n ƒë·∫ßu ti√™n c·ªßa nƒÉm √¢m l·ªãch. L·ªÖ h·ªôi √°nh s√°ng v·ªõi ƒë√®n l·ªìng nhi·ªÅu m√†u s·∫Øc, m√∫a l√¢n v√† th·∫£ ƒë√®n hoa ƒëƒÉng ƒë·ªÉ t∆∞·ªüng nh·ªõ t·ªï ti√™n.',
                traditions: 'Lantern displays, lion dances, releasing floating lanterns',
                offerings: 'Five-fruit tray, vegetarian dishes, sweet rice balls (b√°nh tr√¥i), tea, flowers, incense'
            },
            '3/3': {
                nameEn: 'T·∫øt H√†n Th·ª±c (Cold Food Festival)',
                nameVi: 'T·∫øt H√†n Th·ª±c',
                descriptionEn: 'Ancient festival honoring ancestors where families traditionally eat cold food. Commemorates loyalty and filial piety.',
                descriptionVi: 'L·ªÖ h·ªôi c·ªï x∆∞a t∆∞·ªüng nh·ªõ t·ªï ti√™n, c√°c gia ƒë√¨nh ƒÉn ƒë·ªì ƒÉn l·∫°nh theo truy·ªÅn th·ªëng. T∆∞·ªüng ni·ªám l√≤ng trung th√†nh v√† hi·∫øu th·∫£o.',
                traditions: 'Eating cold food, ancestral worship, tomb sweeping',
                offerings: 'Cold rice, fruits, b√°nh tr√¥i, b√°nh chay (no cooked food), flowers, incense'
            },
            '4/15': {
                nameEn: 'L·ªÖ Ph·∫≠t ƒê·∫£n (Buddha\'s Birthday)',
                nameVi: 'L·ªÖ Ph·∫≠t ƒê·∫£n (Ph·∫≠t Sinh)',
                descriptionEn: 'Celebration of the birth of Gautama Buddha. Buddhists visit pagodas, release birds and fish, and perform acts of kindness.',
                descriptionVi: 'K·ª∑ ni·ªám ng√†y sinh c·ªßa ƒê·ª©c Ph·∫≠t Th√≠ch Ca. Ph·∫≠t t·ª≠ ƒëi ch√πa, ph√≥ng sinh v√† l√†m c√°c vi·ªác thi·ªán.',
                traditions: 'Temple visits, vegetarian meals, releasing captive animals',
                offerings: 'Vegetarian dishes, fruits, flowers, incense, tea, rice. No meat or fish offerings.'
            },
            '5/5': {
                nameEn: 'T·∫øt ƒêoan Ng·ªç (Double Fifth Festival)',
                nameVi: 'T·∫øt ƒêoan Ng·ªç (T·∫øt di·ªát s√¢u b·ªç)',
                descriptionEn: 'Festival for killing insects and preventing diseases. Families eat special fruits, drink ruou nep, and wear protective amulets.',
                descriptionVi: 'T·∫øt di·ªát s√¢u b·ªç v√† ph√≤ng tr√°nh b·ªánh t·∫≠t. Gia ƒë√¨nh ƒÉn tr√°i c√¢y ƒë·∫∑c bi·ªát, u·ªëng r∆∞·ª£u n·∫øp v√† ƒëeo b√πa h·ªô m·ªánh.',
                traditions: 'Eating fruits, drinking rice wine, wearing amulets',
                offerings: 'Seasonal fruits (lychee, plums), sticky rice wine (r∆∞·ª£u n·∫øp), b√°nh √∫, rice, incense'
            },
            '7/7': {
                nameEn: 'Th·∫•t T·ªãch (Double Seventh Festival)',
                nameVi: 'Th·∫•t T·ªãch (Ng∆∞u Lang Ch·ª©c N·ªØ)',
                descriptionEn: 'Vietnamese Valentine\'s Day celebrating the legend of the Cowherd and Weaver Girl who meet once a year on this night.',
                descriptionVi: 'Ng√†y l·ªÖ t√¨nh nh√¢n Vi·ªát Nam k·ª∑ ni·ªám truy·ªÅn thuy·∫øt Ng∆∞u Lang v√† Ch·ª©c N·ªØ g·∫∑p nhau m·ªôt l·∫ßn m·ªói nƒÉm v√†o ƒë√™m n√†y.',
                traditions: 'Romantic celebrations, stargazing, storytelling',
                offerings: 'Fruits, flowers, sweet cakes, tea. Special offerings for couples seeking love.'
            },
            '7/15': {
                nameEn: 'L·ªÖ Vu Lan (Ullambana Festival)',
                nameVi: 'L·ªÖ Vu Lan (B√°o hi·∫øu)',
                descriptionEn: 'Festival honoring parents and ancestors. People wear roses - red for living mothers, white for deceased. Temple ceremonies and charity acts are performed.',
                descriptionVi: 'L·ªÖ h·ªôi t∆∞·ªüng nh·ªõ cha m·∫π v√† t·ªï ti√™n. Ng∆∞·ªùi ta c√†i hoa h·ªìng - ƒë·ªè cho m·∫π c√≤n s·ªëng, tr·∫Øng cho m·∫π ƒë√£ m·∫•t. C·ª≠ h√†nh l·ªÖ ch√πa v√† l√†m t·ª´ thi·ªán.',
                traditions: 'Wearing roses, temple ceremonies, charity, honoring parents',
                offerings: 'Elaborate vegetarian feast, fruits, cakes, flowers, incense, paper offerings for wandering souls. This is the MOST IMPORTANT day for ancestor worship.'
            },
            '8/15': {
                nameEn: 'T·∫øt Trung Thu (Mid-Autumn Festival)',
                nameVi: 'T·∫øt Trung Thu (T·∫øt Thi·∫øu nhi)',
                descriptionEn: 'Harvest moon festival celebrating children. Families gather to eat mooncakes, carry lanterns, watch lion dances, and enjoy the full moon.',
                descriptionVi: 'T·∫øt trƒÉng r·∫±m m·ª´ng tr·∫ª em. Gia ƒë√¨nh sum h·ªçp ƒÉn b√°nh trung thu, r∆∞·ªõc ƒë√®n l·ªìng, xem m√∫a l√¢n v√† ng·∫Øm trƒÉng tr√≤n.',
                traditions: 'Mooncakes, lantern processions, lion dances, family gatherings',
                offerings: 'Mooncakes, five-fruit tray, pomelos, persimmons, tea, incense, lanterns'
            },
            '9/9': {
                nameEn: 'T·∫øt Tr√πng C·ª≠u (Double Ninth Festival)',
                nameVi: 'T·∫øt Tr√πng C·ª≠u (T·∫øt Tr√πng D∆∞∆°ng)',
                descriptionEn: 'Festival for longevity and health. People climb mountains, drink chrysanthemum wine, and honor the elderly.',
                descriptionVi: 'L·ªÖ h·ªôi c·∫ßu s·ª©c kh·ªèe v√† tr∆∞·ªùng th·ªç. Ng∆∞·ªùi ta leo n√∫i, u·ªëng r∆∞·ª£u hoa c√∫c v√† t√¥n k√≠nh ng∆∞·ªùi cao tu·ªïi.',
                traditions: 'Mountain climbing, chrysanthemum wine, honoring elders',
                offerings: 'Chrysanthemum flowers, wine, fruits, cakes, rice, incense'
            },
            '10/10': {
                nameEn: 'T·∫øt H·∫° Nguy√™n (Lower Nguyen Festival)',
                nameVi: 'T·∫øt H·∫° Nguy√™n (T·∫øt C∆°m M·ªõi)',
                descriptionEn: 'Festival of forgiveness and new harvest. Families release water lanterns, pray for peace, and celebrate the new rice harvest.',
                descriptionVi: 'L·ªÖ h·ªôi tha th·ª© v√† m√πa m√†ng m·ªõi. Gia ƒë√¨nh th·∫£ ƒë√®n n∆∞·ªõc, c·∫ßu b√¨nh an v√† m·ª´ng v·ª• l√∫a m·ªõi.',
                traditions: 'Water lanterns, new rice offerings, prayer ceremonies',
                offerings: 'New rice, sticky rice cakes, fruits, flowers, incense, water lanterns'
            },
            '12/8': {
                nameEn: 'L·ªÖ Ph·∫≠t Th√†nh ƒê·∫°o (Buddha\'s Enlightenment)',
                nameVi: 'L·ªÖ Ph·∫≠t Th√†nh ƒê·∫°o (L·ªÖ L·∫°p B√°t)',
                descriptionEn: 'Commemorating Buddha\'s enlightenment under the Bodhi tree. Buddhists eat special porridge and practice meditation.',
                descriptionVi: 'T∆∞·ªüng ni·ªám ng√†y ƒê·ª©c Ph·∫≠t ƒë·∫°t ƒë∆∞·ª£c gi√°c ng·ªô d∆∞·ªõi c√¢y B·ªì ƒê·ªÅ. Ph·∫≠t t·ª≠ ƒÉn ch√°o ƒë·∫∑c bi·ªát v√† t·∫≠p thi·ªÅn.',
                traditions: 'Eight-treasure porridge, meditation, temple ceremonies',
                offerings: 'Eight-treasure porridge (ch√°o l·∫°p b√°t), vegetarian dishes, fruits, flowers, incense, tea'
            },
            '12/23': {
                nameEn: 'T·∫øt T√°o Qu√¢n (Kitchen Gods\' Festival)',
                nameVi: 'T·∫øt T√°o Qu√¢n (√îng T√°o v·ªÅ tr·ªùi)',
                descriptionEn: 'Sending the Kitchen Gods to heaven to report on the family\'s year. Families clean homes, offer carp fish, and prepare for T·∫øt.',
                descriptionVi: 'Ti·ªÖn √îng T√°o v·ªÅ tr·ªùi b√°o c√°o v·ªÅ nƒÉm c·ªßa gia ƒë√¨nh. C√°c gia ƒë√¨nh d·ªçn d·∫πp nh√† c·ª≠a, c√∫ng c√° ch√©p v√† chu·∫©n b·ªã T·∫øt.',
                traditions: 'Releasing carp fish, cleaning house, offering ceremonies',
                offerings: 'Live carp fish (3), sticky rice, fruits, flowers, paper clothes & hats for Kitchen Gods, incense'
            },
            '1/10': {
                nameEn: 'Ng√†y Gi·ªó T·ªï H√πng V∆∞∆°ng (Hung Kings\' Memorial)',
                nameVi: 'Gi·ªó T·ªï H√πng V∆∞∆°ng',
                descriptionEn: 'Memorial day for the Hung Kings, legendary founders of Vietnam. A national holiday honoring Vietnamese origins.',
                descriptionVi: 'Ng√†y gi·ªó c√°c Vua H√πng, t·ªï ti√™n huy·ªÅn tho·∫°i c·ªßa Vi·ªát Nam. Ng√†y l·ªÖ qu·ªëc gia t∆∞·ªüng nh·ªõ ngu·ªìn g·ªëc d√¢n t·ªôc.',
                traditions: 'Temple pilgrimages, offerings, patriotic ceremonies',
                offerings: 'B√°nh ch∆∞ng, b√°nh d√†y, five-fruit tray, flowers, incense'
            },
            '7/1': {
                nameEn: 'Khai H·ªôi Qu·ª∑ (Opening of Ghost Month)',
                nameVi: 'M·ªü C·ª≠a ƒê·ªãa Ng·ª•c',
                descriptionEn: 'Beginning of the Ghost Month when the gates of hell open and spirits roam the earth. Families prepare offerings to appease wandering souls.',
                descriptionVi: 'ƒê·∫ßu th√°ng Qu·ª∑ khi c·ª≠a ƒë·ªãa ng·ª•c m·ªü v√† c√°c linh h·ªìn lang thang tr√™n tr√°i ƒë·∫•t. Gia ƒë√¨nh chu·∫©n b·ªã ƒë·ªì c√∫ng ƒë·ªÉ xoa d·ªãu c√°c h·ªìn ma.',
                traditions: 'Burning incense, food offerings, avoiding night activities',
                offerings: 'Rice, vegetarian food, fruits, paper money, incense'
            },
            '7/14': {
                nameEn: 'Hungry Ghost Festival Eve',
                nameVi: 'ƒê√™m tr∆∞·ªõc Vu Lan',
                descriptionEn: 'Eve of the Vu Lan festival. Families prepare elaborate offerings for ancestors and wandering spirits.',
                descriptionVi: 'ƒê√™m tr∆∞·ªõc l·ªÖ Vu Lan. Gia ƒë√¨nh chu·∫©n b·ªã ƒë·ªì c√∫ng cho t·ªï ti√™n v√† c√°c h·ªìn ma c√¥ h·ªìn.',
                traditions: 'Preparing offerings, cleaning altars, chanting prayers',
                offerings: 'Full feast, vegetarian dishes, fruits, cakes, tea, wine'
            },
            '7/29': {
                nameEn: 'Closing of Ghost Month',
                nameVi: 'ƒê√≥ng C·ª≠a ƒê·ªãa Ng·ª•c',
                descriptionEn: 'Last day of Ghost Month when the gates of hell close and spirits return to the underworld.',
                descriptionVi: 'Ng√†y cu·ªëi th√°ng Qu·ª∑ khi c·ª≠a ƒë·ªãa ng·ª•c ƒë√≥ng l·∫°i v√† c√°c linh h·ªìn tr·ªü v·ªÅ √¢m ph·ªß.',
                traditions: 'Final offerings, burning paper items, prayers of closure',
                offerings: 'Rice, fruits, paper offerings, incense'
            }
        };

        // Altar offerings recommendations (ƒê·ªì C√∫ng B√†n Th·ªù)
        const altarOfferings = {
            // First day of lunar month (M√πng 1)
            'first-day': {
                nameEn: 'First Day of Lunar Month',
                nameVi: 'M√πng M·ªôt √Çm L·ªãch',
                offerings: 'Fresh flowers, fruits (5-fruit tray), incense, rice, salt, water. Optional: vegetarian dishes, sticky rice, b√°nh ch∆∞ng/b√°nh t√©t.'
            },
            // Full moon day (R·∫±m)
            'full-moon': {
                nameEn: 'Full Moon Day (15th)',
                nameVi: 'Ng√†y R·∫±m (M·ªìng 15)',
                offerings: 'Fresh flowers, five-fruit tray, incense, rice, tea, vegetarian food, sweet soups (ch√®), sticky rice cakes. This is a very important day for worship.'
            },
            // Month end
            'month-end': {
                nameEn: 'End of Lunar Month',
                nameVi: 'Cu·ªëi Th√°ng √Çm L·ªãch',
                offerings: 'Incense, fruits, rice, water. Simple offerings to close the month and prepare for the new moon.'
            },
            // Regular days
            'daily': {
                nameEn: 'Daily Worship',
                nameVi: 'C√∫ng H√†ng Ng√†y',
                offerings: 'Fresh incense daily, clean water, fresh flowers (change every 2-3 days). Optional: rice, tea, fruits.'
            }
        };
        
        // Vietnamese Lunar New Year dates (T·∫øt) for multiple years (2020-2035)
        const lunarNewYearDates = {
            2020: new Date('2020-01-25'),
            2021: new Date('2021-02-12'),
            2022: new Date('2022-02-01'),
            2023: new Date('2023-01-22'),
            2024: new Date('2024-02-10'),
            2025: new Date('2025-01-29'),
            2026: new Date('2026-02-17'),
            2027: new Date('2027-02-06'),
            2028: new Date('2028-01-26'),
            2029: new Date('2029-02-13'),
            2030: new Date('2030-02-03'),
            2031: new Date('2031-01-23'),
            2032: new Date('2032-02-11'),
            2033: new Date('2033-01-31'),
            2034: new Date('2034-02-19'),
            2035: new Date('2035-02-08')
        };

        // Lunar calendar conversion with improved accuracy
        function solarToLunar(solarDate) {
            const year = solarDate.getFullYear();

            // Get T·∫øt date for current year and next year
            let lunarNewYear = lunarNewYearDates[year];
            let nextLunarNewYear = lunarNewYearDates[year + 1];
            let lunarYear = year;

            // If date is before this year's T·∫øt, it belongs to previous lunar year
            if (solarDate < lunarNewYear) {
                lunarNewYear = lunarNewYearDates[year - 1];
                nextLunarNewYear = lunarNewYearDates[year];
                lunarYear = year - 1;
            }

            // Calculate days since lunar new year
            const daysDiff = Math.floor((solarDate - lunarNewYear) / (1000 * 60 * 60 * 24));

            // Average lunar month is 29.53 days
            const avgLunarMonth = 29.53;

            // Estimate lunar month and day
            let lunarMonth = Math.floor(daysDiff / avgLunarMonth) + 1;
            let lunarDay = Math.floor(daysDiff % avgLunarMonth) + 1;

            // Adjust for lunar month boundaries (alternate between 29 and 30 days)
            let daysCount = daysDiff;
            lunarMonth = 1;

            while (daysCount >= 29) {
                const monthLength = (lunarMonth % 2 === 1) ? 30 : 29; // Alternating month lengths
                if (daysCount >= monthLength) {
                    daysCount -= monthLength;
                    lunarMonth++;
                } else {
                    break;
                }
            }

            lunarDay = daysCount + 1;

            return {
                year: lunarYear,
                month: Math.max(1, Math.min(12, lunarMonth)),
                day: Math.max(1, Math.min(30, Math.floor(lunarDay)))
            };
        }
        
        function calculateMoonPhase(date) {
            const knownNewMoon = new Date('2000-01-06T18:14:00Z');
            const lunarCycle = 29.530588853; // days
            
            const daysSinceKnownNew = (date - knownNewMoon) / (1000 * 60 * 60 * 24);
            const currentCycle = daysSinceKnownNew % lunarCycle;
            const phase = currentCycle / lunarCycle;
            
            return phase;
        }
        
        function getPhaseInfo(phase) {
            const illumination = Math.abs(Math.cos(phase * 2 * Math.PI));
            
            let phaseName, description;
            
            if (phase < 0.03 || phase > 0.97) {
                phaseName = "New Moon";
                description = "The moon is not visible in the sky";
            } else if (phase < 0.22) {
                phaseName = "Waxing Crescent";
                description = "The moon is growing larger";
            } else if (phase < 0.28) {
                phaseName = "First Quarter";
                description = "Half of the moon is illuminated";
            } else if (phase < 0.47) {
                phaseName = "Waxing Gibbous";
                description = "More than half illuminated, still growing";
            } else if (phase < 0.53) {
                phaseName = "Full Moon";
                description = "The moon is fully illuminated";
            } else if (phase < 0.72) {
                phaseName = "Waning Gibbous";
                description = "More than half illuminated, shrinking";
            } else if (phase < 0.78) {
                phaseName = "Last Quarter";
                description = "Half of the moon is illuminated";
            } else {
                phaseName = "Waning Crescent";
                description = "The moon is shrinking";
            }
            
            return {
                name: phaseName,
                description: description,
                illumination: Math.round(illumination * 100)
            };
        }
        
        function updateMoonDisplay() {
            const phase = calculateMoonPhase(currentDate);
            const phaseInfo = getPhaseInfo(phase);
            
            // Update moon visual
            const moonLight = document.getElementById('moonLight');
            const rotation = phase * 360;
            
            if (phase < 0.5) {
                // Waxing phases
                moonLight.style.background = `linear-gradient(${90 + rotation}deg, #f5f5dc 0%, #f5f5dc 50%, #333 50%, #333 100%)`;
            } else {
                // Waning phases
                moonLight.style.background = `linear-gradient(${rotation - 90}deg, #333 0%, #333 50%, #f5f5dc 50%, #f5f5dc 100%)`;
            }
            
            // Update text info
            document.getElementById('phaseName').textContent = phaseInfo.name;
            document.getElementById('illumination').textContent = `${phaseInfo.illumination}% Illuminated`;
            document.getElementById('phaseDescription').textContent = phaseInfo.description;
            document.getElementById('dateDisplay').textContent = currentDate.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Update lunar date
            const lunarDate = solarToLunar(currentDate);
            document.getElementById('lunarDate').textContent =
                `üåô Lunar Calendar: Month ${lunarDate.month}, Day ${lunarDate.day}, Year ${lunarDate.year}`;
            
            // Check for Vietnamese holidays and display offering information
            const holidayKey = `${lunarDate.month}/${lunarDate.day}`;
            const holidayInfo = document.getElementById('holidayInfo');
            const offeringInfo = document.getElementById('offeringInfo');
            const offeringDescription = document.getElementById('offeringDescription');

            if (vietnameseHolidays[holidayKey]) {
                // Display specific holiday information
                const holiday = vietnameseHolidays[holidayKey];
                document.getElementById('holidayNameEn').textContent = holiday.nameEn;
                document.getElementById('holidayNameVi').textContent = holiday.nameVi;
                document.getElementById('holidayDescriptionEn').textContent = holiday.descriptionEn;
                document.getElementById('holidayDescriptionVi').textContent = holiday.descriptionVi;
                document.getElementById('holidayTraditions').textContent = holiday.traditions;

                // Display offerings if available
                if (holiday.offerings) {
                    offeringDescription.textContent = holiday.offerings;
                    offeringInfo.style.display = 'block';
                } else {
                    offeringInfo.style.display = 'none';
                }

                holidayInfo.style.display = 'block';
            } else {
                // No specific holiday, but check for special lunar days
                let showOfferings = false;
                let offeringType = null;

                if (lunarDate.day === 1) {
                    offeringType = altarOfferings['first-day'];
                    showOfferings = true;
                } else if (lunarDate.day === 15) {
                    offeringType = altarOfferings['full-moon'];
                    showOfferings = true;
                } else if (lunarDate.day >= 29) {
                    offeringType = altarOfferings['month-end'];
                    showOfferings = true;
                }

                if (showOfferings && offeringType) {
                    // Show offering info without holiday info
                    document.getElementById('holidayNameEn').textContent = offeringType.nameEn;
                    document.getElementById('holidayNameVi').textContent = offeringType.nameVi;
                    document.getElementById('holidayDescriptionEn').textContent = '';
                    document.getElementById('holidayDescriptionVi').textContent = '';
                    document.getElementById('holidayTraditions').textContent = '';

                    offeringDescription.textContent = offeringType.offerings;
                    offeringInfo.style.display = 'block';
                    holidayInfo.style.display = 'block';
                } else {
                    holidayInfo.style.display = 'none';
                }
            }
        }
        
        function changeDate(days) {
            currentDate.setDate(currentDate.getDate() + days);
            updateDisplay();
        }
        
        function goToToday() {
            currentDate = new Date();
            updateDisplay();
        }
        
        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            updateDisplay();
        }
        
        function updateCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const today = new Date();
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            document.getElementById('monthYear').textContent = 
                currentDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });
            
            const daysGrid = document.getElementById('daysGrid');
            daysGrid.innerHTML = '';
            
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'day';
                dayElement.textContent = date.getDate();
                
                if (date.getMonth() !== month) {
                    dayElement.style.opacity = '0.3';
                }
                
                if (date.toDateString() === today.toDateString()) {
                    dayElement.classList.add('today');
                }
                
                if (date.toDateString() === currentDate.toDateString()) {
                    dayElement.classList.add('selected');
                }
                
                // Check for Vietnamese holidays and special lunar days
                const lunarDate = solarToLunar(date);
                const holidayKey = `${lunarDate.month}/${lunarDate.day}`;

                // Highlight Vietnamese holidays
                if (vietnameseHolidays[holidayKey]) {
                    dayElement.classList.add('vietnamese-holiday');
                    dayElement.title = `${vietnameseHolidays[holidayKey].nameEn}\n${vietnameseHolidays[holidayKey].nameVi}`;
                }
                // Highlight special lunar days
                else if (lunarDate.day === 1) {
                    dayElement.classList.add('lunar-first-day');
                    dayElement.title = `Lunar Day 1 (M√πng 1)\n${altarOfferings['first-day'].nameVi}`;
                } else if (lunarDate.day === 15) {
                    dayElement.classList.add('lunar-full-moon');
                    dayElement.title = `Lunar Day 15 (R·∫±m)\n${altarOfferings['full-moon'].nameVi}`;
                } else if (lunarDate.day >= 29) {
                    dayElement.classList.add('lunar-month-end');
                    dayElement.title = `End of Lunar Month\n${altarOfferings['month-end'].nameVi}`;
                }

                dayElement.onclick = () => {
                    currentDate = new Date(date);
                    updateDisplay();
                };
                
                daysGrid.appendChild(dayElement);
            }
        }
        
        function updateDisplay() {
            updateMoonDisplay();
            updateCalendar();
        }
        
        // Initialize the app
        updateDisplay();

        // Update every hour
        setInterval(updateDisplay, 3600000);

        // Mobile app banner functionality
        function closeMobileAppBanner() {
            document.getElementById('mobileAppBanner').style.display = 'none';
            localStorage.setItem('appBannerDismissed', 'true');
        }

        // Show banner if not dismissed
        if (localStorage.getItem('appBannerDismissed') !== 'true') {
            const banner = document.getElementById('mobileAppBanner');
            if (banner) {
                banner.style.display = 'flex';
            }
        }
    </script>

    <!-- Mobile App Banner (only shows on mobile) -->
    <a href="mobile-app/index.html" id="mobileAppBanner" class="mobile-app-banner">
        <span class="icon">üì±</span>
        <div class="text">
            <div class="title">Get the Mobile App!</div>
            <div class="subtitle">Daily notifications + offline mode</div>
        </div>
        <button class="close-btn" onclick="event.preventDefault(); closeMobileAppBanner();">√ó</button>
    </a>
</body>
</html>